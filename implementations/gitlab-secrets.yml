include:
  - template: Security/Secret-Detection.gitlab-ci.yml

variables:
  SECRET_DETECTION_DISABLED: $GITLAB_SECRET_SCAN_DISABLED

test2:
  image: alpine
  stage: test
  script:
    - echo $SECRET_DETECTION_DISABLED

secret_detection:
  artifacts:
    paths: 
      - "gl-secret-detection-report.json"

gitlab_secrets_scanning_upload:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "secret_detection"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab Secret Detection Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI Gitleaks Report"
    SAFESCARF_SCAN_FILE: "./gl-secret-detection-report.json"