include:
  - template: Security/SAST.gitlab-ci.yml

sast:
  artifacts:
    paths:
      - gl-sast-report.json

semgrep-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "semgrep-sast"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab SAST Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI Semgrep"
    SAFESCARF_SCAN_FILE: "./gl-sast-report.json"
  rules:
    - !reference [semgrep-sast, rules]

brakeman-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "brakeman-sast"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab SAST Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI Brakeman"
    SAFESCARF_SCAN_FILE: "./gl-sast-report.json"
  rules:
    - !reference [brakeman-sast, rules]

flawfinder-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "flawfinder-sast"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab SAST Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI Flawfinder"
    SAFESCARF_SCAN_FILE: "./gl-sast-report.json"
  rules:
    - !reference [flawfinder-sast, rules]

kubesec-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "kubesec-sast"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab SAST Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI KubeSec"
    SAFESCARF_SCAN_FILE: "./gl-sast-report.json"
  rules:
    - !reference [kubesec-sast, rules]

mobsf-android-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "mobsf-android-sast"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab SAST Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI Mobsf Android"
    SAFESCARF_SCAN_FILE: "./gl-sast-report.json"
  rules:
    - !reference [mobsf-android-sast, rules]

mobsf-ios-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "mobsf-ios-sast"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab SAST Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI Mobsf IOS"
    SAFESCARF_SCAN_FILE: "./gl-sast-report.json"
  rules:
    - !reference [mobsf-ios-sast, rules]

nodejs-scan-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "nodejs-scan-sast"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab SAST Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI NodeJs Scan"
    SAFESCARF_SCAN_FILE: "./gl-sast-report.json"
  rules:
    - !reference [nodejs-scan-sast, rules]

phpcs-security-audit-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "phpcs-security-audit-sast"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab SAST Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI PHPCS Security Audit"
    SAFESCARF_SCAN_FILE: "./gl-sast-report.json"
  rules:
    - !reference [phpcs-security-audit-sast, rules]

pmd-apex-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "pmd-apex-sast"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab SAST Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI PMD Aepx"
    SAFESCARF_SCAN_FILE: "./gl-sast-report.json"
  rules:
    - !reference [pmd-apex-sast, rules]

security-code-scan-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "security-code-scan-sast"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab SAST Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI Security Code Scan"
    SAFESCARF_SCAN_FILE: "./gl-sast-report.json"
  rules:
    - !reference [security-code-scan-sast, rules]

sobelow-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "sobelow-sast"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab SAST Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI Sobelow"
    SAFESCARF_SCAN_FILE: "./gl-sast-report.json"
  rules:
    - !reference [sobelow-sast, rules]

spotbugs-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "spotbugs-sast"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab SAST Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI Spotbugs"
    SAFESCARF_SCAN_FILE: "./gl-sast-report.json"
  rules:
    - !reference [spotbugs-sast, rules]
