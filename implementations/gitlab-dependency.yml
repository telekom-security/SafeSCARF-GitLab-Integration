include:
  - template: Security/Dependency-Scanning.gitlab-ci.yml

.cyclonedx-reports:
  artifacts:
    paths:
      - "**/gl-sbom-*.cdx.json"
      - "gl-dependency-scanning-report.json"

gemnasium-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "gemnasium-dependency_scanning"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab Dependency Scanning Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI Gemnasium"
    SAFESCARF_SCAN_FILE: "./gl-dependency-scanning-report.json"
  rules:
    - !reference [gemnasium-dependency_scanning, rules]

gemnasium-maven-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "gemnasium-maven-dependency_scanning"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab Dependency Scanning Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI Gemnasium Maven"
    SAFESCARF_SCAN_FILE: "./gl-dependency-scanning-report.json"
  rules:
    - !reference [gemnasium-maven-dependency_scanning, rules]

gemnasium-python-safescarf:
  extends: .safescarf_upload
  needs: ["safescarf_create_engagement", "gemnasium-python-dependency_scanning"]
  variables:
    SAFESCARF_SCAN_TYPE: "GitLab Dependency Scanning Report"
    SAFESCARF_SCAN_TEST_TYPE: "GitLab-CI Gemnasium Python"
    SAFESCARF_SCAN_FILE: "./gl-dependency-scanning-report.json"
  rules:
    - !reference [gemnasium-python-dependency_scanning, rules]
